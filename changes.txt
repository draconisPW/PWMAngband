=================
PWMAngband 1.1.11
=================

This new version has a few significant changes ported from the Angband 4.0.x
series.

For a full list of changes made in older versions, check the Official
PWMAngband Forum: http://www.mangband.org/forum/viewforum.php?f=9

Features from Angband 4.x and MAngband 1.x are explicitely mentioned. Other
changes and fixes are specific to PWMAngband.

New features in PWMAngband 1.1.11 build 10
==========================================

Bugs fixed
----------

PWMAngband:

- Fix monsters breathing at a random square next to the player instead of
  breathing directly at the player
- Redraw the floor when walking over objects while wearing an auto-ID item
- Learn object activation on use, not automatically when the object is created

Features in PWMAngband 1.1.11 build 9
=====================================

User interface
--------------

MAngband 1.2:

- Add owner info for DMs (artifact list)

Gameplay changes
----------------

MAngband 1.2:

- Change message for wilderness food and add a tiny bit of healing
- Remove artifact dropping restriction from ironman

PWMAngband:

- Bypass the "Get out of icky screens when disturbed" option for the following
  commands: Wear/wield an item ('w'), Use a staff ('u'), Aim a wand ('a'),
  Zap a rod ('z'), Activate an object ('A'), Eat some food ('E'),
  Quaff a potion ('q'), Read a scroll ('r') and Cast a spell ('m')

Bugs fixed
----------

Angband 4.0.x:

- Change tomb preposition for date

MAngband 1.1.4:

- Fix buffer overflow in console
- Players shouldn't be able to pickup items while paralyzed

PWMAngband:

- Fix crash when quitting the GCU client
- Fix small visual glitch when displaying the non crypted password as xxxxxx

Coding changes
--------------

Angband 4.0.x:

- New sound module (for SDL and Windows clients)
- Parser arg to state err or quit on file not found

MAngband 1.2:

- Use array of buffers in format(), allow up to 5 consecutive calls
- Replace calls to quit(format()) and plog(format()) by quit_fmt() and
  plog_fmt()
- Always alloc/dealloc interactive_file string
- Rename init_stuff() to init_stuff_win() on windows client
- Ensure returned string is static in conf_get_string()
- Ensure msg_log[i] check is not pointless
- Add const qualifier to temporary "c" char* in do_cmd_observe
- Ensure virt_channels are initialized
- Quit early when there's no space for special levels
- Add proper command-line parsing to mangclient
- Fix some warnings
- Replace all occurences of strcasecmp/strncasecmp with my_stricmp/my_strnicmp
- Normalize name/pass buffer and string lengths
- Fix a possible overflow during chat channel cycling
- Replace calls to fprintf with no format specifier (file_putf -> file_put)
- Cleanup name checking a bit

PWMAngband:

- When both special pre-designed level and town exist for a given depth, load
  the town on no_recall or more_towns servers and the level on other servers

Features in PWMAngband 1.1.11 build 8
=====================================

User interface
--------------

Angband 4.0.x:

- Fix the worst cases of double negative options, rearrange the options a bit

PWMAngband:

- Dungeon Master menu: add command to generate static levels where monsters can
  spawn

Bugs fixed
----------

PWMAngband:

- Fix crash when an object dropped under a player is combined with a similar
  object
- Allow digits and extra symbols ('-', '*') in "fuzzy" name parsing when
  searching for monsters, objects and vaults by name
- Cancel repeated commands (searching and digging) with any new command, and not
  just Escape

Coding changes
--------------

Angband 4.0.x:

- Removed magic numbers from CUT timer

PWMAngband:

- Save static levels as "server.level.x.y.z", rename town files to
  "server.town.x.y.z"

Features in PWMAngband 1.1.11 build 7
=====================================

Bugs fixed
----------

Angband 4.0.x:

- Fixes for monster list
- Fixes for object list
- Force panel/map refresh if player is disturbed while running

PWMAngband:

- Fix monsters never dropping anything if killed while still asleep
- Fixes for object identification and knowledge
- Redraw floor when blindness wears off (to identify any scroll or staff of
  darkness used from the floor)
- Redraw spells when stun wears off
- Fix crash when trying to shimmer objects for players leaving a level

Coding changes
--------------

Angband 4.0.x:

- Fix some compiler warnings

Features in PWMAngband 1.1.11 build 6
=====================================

Gameplay changes
----------------

PWMAngband:

- Slightly decrease fail rate of Fire Bolt for Sorcerors
- Use a random direction if no direction is given for breathing effects
- Rewrite thrusting effect for force breaths using project_path(), stopping at
  the first monster, player or wall

Bugs fixed
----------

Angband 4.0.x:

- Only get a message in become_aware() if mimic is in view
- Give a correct description for breath activations

PWMAngband:

- Fix tracking of monster hit by force effect
- Fix tracking of player hit by some effect that modifies location (nexus,
  gravity, teleport, force...)
- Don't save player trap/object knowledge in the savefile if the character is
  dead
- Make drinking from a fountain use a turn

Coding changes
--------------

Angband 4.0.x:

- Make building directory paths a bit more robust

PWMAngband:

- Remove project_hurt hack, use SQUARE_PROJECT instead

Features in PWMAngband 1.1.11 build 5
=====================================

User interface
--------------

Angband 4.0.x:

- Only update player map knowledge on seeing or mapping
- Only update player object knowledge on seeing or detecting
- Improve screen updates
- Improved profile for town lava streamers (750ft ironman town layout)

PWMAngband:

- Remove radius from breath effect description
- Only update player trap knowledge on seeing or detecting
- New walls for ironman town layout at 750ft
- Cancel object tracking if the object is on the floor when leaving a level

Gameplay changes
----------------

Angband 4.0.x:

- Basic cone-shaped breaths
- Add thrusting effect for force breaths
- Change WAND_BREATH activation and Dragon's Flame/Frost/Breath effects from
  BALL to BREATH
- Make trap location detect chests

PWMAngband:

- Make trap location also detect visible traps

Bugs fixed
----------

PWMAngband:

- Really fix parsing error when parsing female player presets (Shockbolt
  tileset)
- Fix Wipe spell (update visuals)
- Fix projection effects on terrain (light, visuals and flow)
- Prevent casting darkness on safe floor tiles (they should always remain lit)
- Fix player forgetting the level layout when entering a suburb area
- Fix hallucinations on non-dungeon permanent walls (house, arena...)
- Prevent controlled monsters from picking up items, allow others to do so again
- Fix crash when freeing player struct
- Describe targeted objects properly when the player is blind
- Prevent non crypted password from showing up at "Enter password" prompt,
  display "(default)" instead
- Fix "You are not experienced enough to drop items" message spamming when a
  level 1 character tries to ignore items
- Properly boost magic device damage according to character device skill
- Fix another bug in the slay cache
- Fix a bug when stacking an unknown item with a similar item bought from a shop
- Use a charge from the right staff after pack reordering when using a staff
  of identify to identify another staff

Coding changes
--------------

Angband 4.0.x:

- Use ANSI standard where feasible
- Use known cave to memorize terrain
- Use known cave to memorize objects
- Add known field to struct object, set it when object becomes known
- Move ID to known objects

PWMAngband:

- Use known cave to memorize traps
- Remove a useless object knowledge flag

Compilation
-----------

- LIBPNG upgraded to version 1.6.21

Features in PWMAngband 1.1.11 build 4
=====================================

User interface
--------------

Angband 4.0.x:

- Improve town generation ("new" town layout used for ironman town at 750ft)
- UI lore: add line for when you've learned everything about a monster; make
  probing learn everything
- Update store names, so that they are similar to store names in terrain.txt

PWMAngband:

- Increase size of "new" town layout to 132x44 (twice as big as Angband)
- Move misc. panel (character screen) one column to the right
- Display ego activation info in character dumps
- Only display "missed" artifact entries if preserve mode is off (artifact
  preservation mode PRESERVE_ARTIFACTS = 0 in mangband.cfg)

Gameplay changes
----------------

PWMAngband:

- Make Mage/Elven Staves always (1d1)
- Make randart Mage/Elven Staves always (+0,+0)
- New server option: extended store purse (doubles each store owner's max purse)
- Always apply side effects from player spells as long as the target doesn't
  resist those effects and damage is dealt by the spell (poison, shards, ice...)
- Make Mind Blast/Brain Smash much more powerful
- Consider Mind Vision/Telekinesis to be successfully cast when there is no
  player around to cast the spell on

Bugs fixed
----------

Angband 4.0.x:

- Fix (Grand) Master Mystics not having a spider escort
- Make monster list update after detection

PWMAngband:

- Fix spell level of Poison Shots
- Properly set return value to PARSE_ERROR_INTERNAL in process_pref_file_named()
  when file to parse is not found, enabling graphical flavors to be loaded again
- Only display a list of items that can be carried when picking up items from a
  pile to avoid crashing the server
- Fix parsing error when parsing female player presets (Shockbolt tileset)
- Make shimmering objects properly shimmer if they're the first object of a pile
  containing ignored items
- Fix Cure Light Wounds spell for Rangers
- Fix Cell Adjustment spell for Telepaths
- Fix Mind Blast/Brain Smash spell descriptions for Shapechangers
- Fix "invicible" typo in hints.txt

Coding changes
--------------

Angband 4.0.x:

- Improve efficiency of object list
- More code improvements from the Angband 4.0.5 release 

PWMAngband:

- Indent object.txt again so that description lines are at most 80 characters
  long
- Change line wrapping length from 75 to 74 to avoid bad wrapping in oook ladder
  dumps

Features in PWMAngband 1.1.11 build 3
=====================================

Gameplay changes
----------------

PWMAngband:

- Give archers an extra shot at levels 15, 30 and 45 with any missile launcher
  (this should rebalance damage output of sling vs bow vs crossbow)

Bugs fixed
----------

PWMAngband:

- Fix crash when trying to lay a rune of protection on top of an (ignored)
  object
- Fix slay cache again, preventing it from filling up and looping on 65536
  entries indefinitely potentially leading to memory leaks and crashes
- Fix crash when an archer kills something with the ball effect from a branded
  ranged attack if delayed messages are pending
- Display death message properly after all other pain/effect messages when an
  archer kills something with the ball effect from a branded ranged attack
- Rearrange quiver automatically after inscribing/uninscribing missiles
- Save archer brand info in the savefile (doesn't break savefile compatibility)
- Give monsters a chance to retaliate if attacked by weaker controlled monsters
- Save terrain under monster (for feature mimics) in the savefile (doesn't break
  savefile compatibility)

Features in PWMAngband 1.1.11 build 2
=====================================

User interface
--------------

PWMAngband:

- New corrected ironman town layout at 750ft

Gameplay changes
----------------

PWMAngband:

- Don't reset object visibility flag (MARK_SEEN) when clearing cave flags for
  a player if the object is inside a house owned by that player

Bugs fixed
----------

PWMAngband:

- Stop generating lava tiles on the border of "new town" levels
- Display "You do not have enough room for this item" when trying to buy
  something with a full pack instead of "Buy how many? (max 0)"
- Fix plural of Knight Templar
- Don't notice ignored chests when searching or detecting traps
- Don't try to open or disarm ignored chests
- Fix a stupid bug which prevented items from dropping near a location which
  contained a trap or rune of protection
- Fix a critical bug which increased the stun counter by an absurd amount when
  something breathed sound, gravity or plasma on a character without protection
  from stunning

Features in PWMAngband 1.1.11 build 1
=====================================

User interface
--------------

Angband 4.0.x:

- Add debug command to perform effects (Dungeon Master menu)
- Add timed flags display to character flag screen
- Add message if a summon fails
- Recolour permanent walls
- Separate quiver list
- Give the elven rings unique object names
- Add ego-item ignoring menu
- Remove cfg_small_range option
- Make player life history editable (accessible in PWMAngband from the 'C' menu)
- Make object selection use a real menu
- New effect descriptions
- New icon (Mr Att) for executable file
- New town layout (in PWMAngband, this is only used to generate the static
  ironman town at 750ft -- base town at 0ft remains the same)
- Add quiver viewing command ('|' key)
- New splashscreen
- Update Nomad's graphics
- Add trap knowledge screen
- Add descriptions for terrain
- Add a sound for objects being dropped from or carried to the quiver
- Divide object list into seen and aware
- New monster spell messages from Elsairon
- Put subwindow options in a separate file so they work for all characters
- Order quiver ammo from worst to best
- Make resting and statusline display for deep descent work like for recall
- Shorten inventory prompt, put overweight info in 'C' screen
- Split launcher and DSM types for ignoring purposes

PWMAngband:

- Display minimap like Angband
- Remove font-xxx.prf, setting the same default color for inventory display
  for all players (configurable server-side in object_base.txt)
- Make town building walls (stores + houses) regular permanent walls
- Move MAngband permanent walls (suburb houses + arenas) to their own terrain
  feature, leave house walls brown, make arena walls red
- Display a red "-" instead of a green "+" for negative modifiers on the
  character sheet
- Split fixed pval/modifier commands for item generation (Dungeon Master menu)
- Add new fixed flavor ("Black Ring") for randart Rings of Power
- Add a Summon Pet command to the Dungeon Master menu
- Add an entry for the "unknown item" and "unknown treasure" tiles for all
  tilesets
- Slightly alter town layout, reduce feature array size from 12x6 to 11x6
- Tell Shapechangers they cannot gain spells instead of browsing unexisting
  books
- Make spell list subwindow display spells for Shapechangers and player ghosts
- Remove check against maximum window size during setup mode to eliminate
  dependency with dungeon dimensions, use server-side check instead
- Display "You see (top item) on a pile." instead of actually listing all
  objects when moving on a square that contains a pile of objects
- Remove the '%' command (Interact with keymaps): the menu can be accessed by
  pressing '=' (Interact with options) and then 'k' (Edit keymaps)
- Remove vault generation by index (Dungeon Master menu)
- Roguelike keyset: move "Display connected players" command from '|' to CTRL-V
- Display trap description when looking at a trap and pressing 'r'
- Display terrain description when looking at a feature and pressing 'r'
- Replace "Save keymaps and options" by "Save options to pref file" and only
  save options + window settings (keymaps can already be saved from the
  "Interact with keymaps" submenu)
- Never show empty equipment/inventory/quiver/floor list
- Merge some new effect descriptions from Angband, update activation and spell
  descriptions accordingly
- Display number of player/active turns elapsed in real game turns (without
  dividing them by the FPS parameter)
- Display number of game/player/active turns immediately after entering the game
- Dungeon Master menu: add command to generate true artifacts for debug purposes
- While running, only update object/monster lists when panel changes
- Generate houses as lit rooms

Gameplay changes
----------------

Angband 4.0.x:

- Remove fired status
- Describe object plusses and modifiers regardless of the player, using
  identification flags from the object exclusively
- Remove class choices, make them all available for each race
- Make dropping ignored items use energy
- Allow barehanded combat to get multiple blows (important note: this doesn't
  affect monks in PWMAngband which still get 1 + character level / 10 blows
  per round)
- Triple the number of room templates, add another 200 (for a total of 500)
- Add stair-skip constant, making stairs go up or down that number of levels
- Make Potions of Resist Poison also cure poison
- Disturb on first getting the object feeling
- Improve pickup of partial stacks

PWMAngband:

- Allow wands of polymorph to work on self
- Implement the BERSERKER activation like Angband
- Implement the healing spells like Angband (in PWMAngband, they will only cure
  blindness and confusion if projectable)
- Change duration of slowing effect to 15+1d25 turns (Angband value)
- Allow General Store to buy food from crops
- Make digging time for all trees equal
- Make wilderness level generation a "one-time" process: generate objects and
  monsters once (for the first player that enters the level), then only
  generate the layout ("deserted" level)
- Tweak some of the PWMAngband artifacts and add more to ensure that every
  object kind has a corresponding non-cursed non-aggravating artifact
- Make Shapechangers polymorphing into a monster susceptible to fire/cold
  actually vulnerable to fire/cold
- Increment quiver size from five to eight slots
- Give the Dungeon Master (or all players in debug mode) all books at birth
  instead of only deep books
- Give Wands of Stinking Cloud radius 3 like Angband
- Improve the Wonder effect in PvP mode
- Let KILL_WALL spells hurt players vulnerable to rock remover in PvP mode
- Let DISP_EVIL/DISP_UNDEAD spells hurt evil/undead players in PvP mode
- Allow pets/slaves to attack a player instead of a monster if that player is
  the closest target
- Make DEATH spells work on players in PvP mode
- Don't crush objects when an artifact cannot be dropped, drop the artifact
  elsewhere on the level instead
- Allow piles of objects (use default Angband value of 23 objects per dungeon
  grid)
- Drop gold after all carried items when the character dies, remove the 32000
  gold coin cap
- Preserve mana (for spells) and consumables in some cases where an effect
  cannot be triggered on a specific level (usually on static levels)
- Deal with ignored stuff (dropping all ignored items) only on random levels
  (to avoid littering town, wilderness and static levels)
- Don't halve extra blows given by equipped items when a monk is encumbered
- Halve the barehanded damage bonus from ghost melee attacks so that it doesn't
  get too good compared to the barehanded damage monks/dragons get since now
  ghosts also get multiple attacks per round
- Make all monsters find a safe place when fleeing (it was limited to smart
  monsters before)
- Forbid summoning in arenas
- Apply off-weapon brands and slays (from items or monster form) to all
  barehanded attacks (special monk/dragon attacks + basic barehanded attacks)
- Slightly alter energy system: give frame_energy to players and monsters every
  frame (every 1/FPS second); allow them to act once move_energy has been
  accumulated; use up move_energy when they act, leaving (energy - move_energy)
  for the next turn; make monsters with more energy than their closest player
  act first, so that slower monsters never get double moves against players
  (change from the Angband 2.9 era that was never ported to MAngband)
- Apply elemental damage (which damages inventory) before physical damage when
  dealing with monster elemental melee attacks
- Allow browse/study/cast from a book on the floor
- New server option: turn-based mode (makes the server turn-based if there is
  only one player connected)
- Make "Stay still" command use energy (via ',' or '5')
- New server option: limited telepathy (makes telepathy limited to a radius of
  "max_sight" like Angband)
- Stop restricting monster/player visibility (line of sight or telepathy) to the
  current panel
- Limit to-dam on artifact missiles (to make ego missiles still valuable)
- Make Resilience a one-time effect setting monster lifespan to maximum value
- Check for monster respawn every 10 turns (Angband rate)
- Let fainting and starving effects occur in town areas
- Make anti-summon field "imperfect" (range 8-11 field with 65-95% chance of
  disrupting any summon attempts)
- Don't record a real "death" when a player uses the Undead Form or Death spells
- Prevent ghosts from casting Undead Form or Death spells
- Give monsters a chance to retaliate if attacked by controlled monsters
- Don't make controlled monsters always visible
- Give controlled monsters a (small) chance to break free from their master's
  control when out of awareness range
- Don't allow TELE_TO effect to teleport something outside a vault next to
  something inside a vault (it will still work if both caster and target are
  inside the same vault)

Bugs fixed
----------

Angband 4.0.x:

- Fix message pain for meteor swarm hitting multiple similar monsters
- Fix shatter moving player (skip remaining blows)
- Make Study indicator active for spellbooks on the ground

PWMAngband:

- Properly tag all water tiles as "icky" when building moats
- Consider all features as "memorized" for DM_SEE_LEVEL characters
- Fix berserk strength description (increases to-hit by +24, not +12)
- Fix typo "You hit by something!" when projecting a spell
- Remove pointless direction choice for the Mass Sleep spell (arcane realm)
- Fix stun amount for monster ice projections
- Apply sleep effect after damage to avoid monster from waking up instantly
- Make logs undiggable
- Fix description not mentioning the fail rate when describing an activation
- Hopefully fix "net write error" disconnections when generating a cavern level
  with a large screen
- Prevent dungeon generator from chopping the corners of rooms off when
  generating wide corridors
- Fix dungeon generator not placing any intersection doors when generating wide
  corridors
- Remove "LIGHT" from the list of abilities when generating an item that can
  have a random ability (Dungeon Master menu)
- Fix typo "You hit by something strange!" when hit by chaos effects
- Fix crash when casting Cold Brand with a Necromancer
- Objects with "LIGHT" modifier: hide light radius and refueling info if not
  known, show light radius when worn, show light radius and refueling info when
  identified
- Don't show pointless "worn" special inscription when looking at an unaware
  identified ring or amulet
- Allow Sorcerors to cast Resistance on others
- Remove pointless direction choice for the Displace Other spell (psi realm)
- Fix Teleport Level for Shapechangers: add missing direction choice and stop
  crashing when using the spell on monsters
- Update some spell descriptions for Shapechangers
- Fix an entertaining bug when casting Anime Dead/Raise Dead spells while
  any player in line of sight (including the caster) was standing on a corpse
  or a skeleton
- Fix mana balls/breaths power (value is 100, not 30)
- Don't let LIGHT_WEAK spells hurt players not vulnerable to light in PvP mode
- Don't let PSI_DRAIN/OLD_DRAIN/DRAIN spells hurt nonliving players in PvP mode
- Fix mass effect spells not working on players in PvP mode
- Fix crash when casting Alter Reality
- Make RAISE spells work much more often by using the same desired level for
  raised monsters as for any summon
- Fix floor display (load/save screen and prompt for a key) when looking at a
  pile of objects and pressing 'r' for details
- Fix crash when attacking someone with a "slay" weapon in PvP mode
- Don't allow players to steal artifacts from other players
- Properly describe stolen item if the thief is unaware of the stolen item's
  flavor
- Display correct number of turns when describing food or activatable items
- Properly display store inventory when using pseudo-3D tiles
- Fix crash due to monster closest player index not properly updated when a
  player leaves the game
- Make message_flush() really flush messages, so that last messages prior to
  character death are recorded in the message subwindow
- Update subwindows when ignoring an item on the floor
- Make houses bought with a Deed of Property "free" (they sell for 0 gold) to
  prevent cheezing by endlessly buying a house with a starter character then
  immediately selling it and transferring the gold to another starter character
- Calculate torchlight radius when generating a new level so that players going
  down from town during daylight don't find themselves in the dark for a turn
- Reveal the mimic instead of destroying the feature when using Trap/Door
  Destruction or Stone to Mud on a Door mimic
- Remove pit floors properly after an earthquake or destruction effect
- Don't clear pit floors when deleting a feature mimic inside a pit
- Fix randart generation not taking into account slays/brands power
- Fix slay cache, allowing object power to be calculated properly
- Dungeon Master menu: fix summoning commands
- Prevent friendly monsters from picking up items on the floor
- Make true artifacts dropped in unauthorized places (house, wilderness...)
  stay in inventory instead of vanishing forever
- Fix failing to use a magic device not taking a turn
- Properly set the timout on activatable items after item request (identify,
  recharging...)
- Fix wrong message when a monster fails to summon due to a player using the
  Suppress Summoning spell
- Fix monsters with more energy than the closest player regenerating twice
- Fix monsters regenerating way too often
- Break long messages (over 80 characters) into multiple pieces so that they are
  not truncated in the message history log
- Fix Black Rings of Power having no weight

Coding changes
--------------

Angband 4.0.x:

- Complete code restructure: for a full list of changes, check changes.txt from
  any of the Angband 4.0.x releases, or http://rephial.org/release/4.0.0

PWMAngband:

- Refactor archer spells
- Refactor options, factorize duplicate code
- Renumber terrain features to match Angband more closely
- Move maximum number of objects per level to a hardcoded constant, limiting it
  to 13068
- Move ghost abilities and mimic spells to class.txt
- Move "near" messages to class.txt
- Factorize MvP and MvM code
- Reorder packets by type, reorganize netclient and netserver files
- Don't save third-person player history in the savefile, generate it when
  asking for player description instead
- Don't save object descriptions in the savefile (obsolete)
- Make quit() call exit_game_panic() to save players and server state in case
  of a forced quit

Documentation
-------------

Angband 4.0.x:

- Update help files
- Complete lib directory re-org
- Add modifying.txt help file

PWMAngband:

- Add lib/readme.txt from Angband
- Update some URLs in manual.txt

Compilation
-----------

- PYTHON upgraded to 32-bit version 2.7.11
- Removed dependencies to DOCUTILS and SETUPTOOLS by installing rst2pdf
  directly from Python (using pip)
- LIBPNG upgraded to version 1.6.20
- FREETYPE upgraded to version 2.6.2
- NOTEYE upgraded to version 8.3